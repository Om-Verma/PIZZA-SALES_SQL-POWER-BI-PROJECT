<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c3{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left;height:16pt}.c10{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c7{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c8{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c9{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c6{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c2{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c4{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c4 doc-content"><p class="c9 title" id="h.9z4p58i9ip1z"><span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pizza sales : Query</span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><h2 class="c3" id="h.pdy5y86fjhm0"><span class="c5"></span></h2><h2 class="c7" id="h.2cvbvdeh3z9b"><span class="c5">A: KPIs</span></h2><p class="c0"><span class="c1"></span></p><h3 class="c10" id="h.vhbdy6tcmcxq"><span class="c6">1: Total Revenue:</span></h3><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT SUM(total_price) as Total_Revenue from pizza_sales;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 197.00px; height: 129.00px;"><img alt="" src="images/image14.png" style="width: 197.00px; height: 129.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">2: Average Order Value:</span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT SUM(total_price)/COUNT(distinct(order_id)) as &#39;Avg_Order_Value&#39; from pizza_sales;</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 191.00px; height: 101.00px;"><img alt="" src="images/image11.png" style="width: 191.00px; height: 101.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">3: Total pizzas sold</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT SUM(quantity) as &#39;Total_Pizza_Sold&#39; from pizza_sales;</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 202.50px; height: 105.37px;"><img alt="" src="images/image5.png" style="width: 202.50px; height: 105.37px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">4: Total Orders</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT COUNT(DISTINCT(order_id)) AS &#39;Total Orders&#39; FROM pizza_sales;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 262.00px; height: 154.00px;"><img alt="" src="images/image8.png" style="width: 262.00px; height: 154.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">5. Average order value:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT SUM(total_price)/ COUNT(DISTINCT ORDER_id) as &#39;avg order value&#39; from pizza_sales</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 248.00px; height: 174.00px;"><img alt="" src="images/image4.png" style="width: 248.00px; height: 174.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">6. Total pizzas sold:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT SUM(quantity) as &#39;Total pizzas sold&#39; from pizza_sales</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 275.50px; height: 198.86px;"><img alt="" src="images/image13.png" style="width: 275.50px; height: 198.86px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">7. Average pizzas per order</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT CAST(</span></p><p class="c2"><span class="c1">CAST(SUM(quantity) AS DECIMAL(10,2)) / </span></p><p class="c2"><span class="c1">CAST(COUNT(distinct order_id) AS DECIMAL(10,2)) </span></p><p class="c2"><span class="c1">as decimal(10,2)) </span></p><p class="c2"><span class="c1">as &#39;AVG_PIZZAS_PER_ORDER&#39;</span></p><p class="c2"><span class="c1">from pizza_sales;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 293.00px; height: 182.00px;"><img alt="" src="images/image10.png" style="width: 293.00px; height: 182.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">8. Daily trends for total orders:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">select DATENAME(DW,order_date) as order_day, </span></p><p class="c2"><span class="c1">count(DISTINCT order_id) as Total_orders</span></p><p class="c2"><span class="c1">from pizza_sales</span></p><p class="c2"><span class="c1">group by DATENAME(DW,order_date);</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 272.00px; height: 240.00px;"><img alt="" src="images/image3.png" style="width: 272.00px; height: 240.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">9. Monthly trends for total orders:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">select DATENAME(MONTH,order_date) as Month_Name, </span></p><p class="c2"><span class="c1">count(DISTINCT order_id) as Total_orders</span></p><p class="c2"><span class="c1">from pizza_sales</span></p><p class="c2"><span class="c1">group by DATENAME(MONTH,order_date);</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 263.00px; height: 329.00px;"><img alt="" src="images/image1.png" style="width: 263.00px; height: 329.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">For descending order:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">select DATENAME(MONTH,order_date) as Month_Name, </span></p><p class="c2"><span class="c1">count(DISTINCT order_id) as Total_orders</span></p><p class="c2"><span class="c1">from pizza_sales</span></p><p class="c2"><span class="c1">group by DATENAME(MONTH,order_date)</span></p><p class="c2"><span class="c1">Order by total_orders DESC;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 197.82px; height: 236.50px;"><img alt="" src="images/image6.png" style="width: 197.82px; height: 236.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">10: % of sales by pizza category:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT Pizza_Category , </span></p><p class="c2"><span class="c1">sum(total_price) as total_sales,</span></p><p class="c2"><span class="c1">sum(total_price)*100/(SELECT sum(total_price) from pizza_sales) as &#39;% total sales&#39;</span></p><p class="c2"><span class="c1">from pizza_sales</span></p><p class="c2"><span class="c1">group by pizza_category;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 434.00px; height: 173.00px;"><img alt="" src="images/image15.png" style="width: 434.00px; height: 173.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">applying the where clause to get the monthly data:</span></p><p class="c2"><span class="c1">SELECT Pizza_Category , </span></p><p class="c2"><span class="c1">sum(total_price) as total_sales,</span></p><p class="c2"><span class="c1">sum(total_price)*100/(SELECT sum(total_price) from pizza_sales where MONTH(order_date)=1) as &#39;% total sales&#39; </span></p><p class="c2"><span class="c1">from pizza_sales</span></p><p class="c2"><span class="c1">where MONTH(order_date)=1</span></p><p class="c2"><span class="c1">group by pizza_category;</span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">&ndash;Note: month (order_date)=1 means january</span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">11. &nbsp;Percentage sales by pizza size: (WHERE clause for selecting quarter)</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT Pizza_size , </span></p><p class="c2"><span class="c1">cast(sum(total_price) as decimal (10,3)) as total_sales ,</span></p><p class="c2"><span class="c1">cast(sum(total_price)*100/</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; (SELECT sum(total_price) from pizza_sales) as decimal(10,3)) as PCT</span></p><p class="c2"><span class="c1">from pizza_sales</span></p><p class="c2"><span class="c1">where DATEPART(quarter,order_date)=1</span></p><p class="c2"><span class="c1">group by pizza_size</span></p><p class="c2"><span class="c1">order by PCT desc;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 249.00px; height: 177.00px;"><img alt="" src="images/image7.png" style="width: 249.00px; height: 177.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">12: top 5 pizza by total revenue:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT TOP 5 pizza_name, sum(total_price) AS Total_Revenue </span></p><p class="c2"><span class="c1">from pizza_sales</span></p><p class="c2"><span class="c1">group by pizza_name</span></p><p class="c2"><span class="c1">ORDER BY Total_Revenue desc;</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 337.00px; height: 203.00px;"><img alt="" src="images/image9.png" style="width: 337.00px; height: 203.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">13: top 5 pizza by total quantity :</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT TOP 5 pizza_name, sum(quantity) AS Total_Quantity </span></p><p class="c2"><span class="c1">from pizza_sales</span></p><p class="c2"><span class="c1">group by pizza_name</span></p><p class="c2"><span class="c1">ORDER BY Total_Quantity &nbsp;desc;</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 363.00px; height: 215.00px;"><img alt="" src="images/image12.png" style="width: 363.00px; height: 215.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">14: top 5 pizza by total_orders :</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">SELECT TOP 5 pizza_name, sum(quantity) AS Total_Quantity </span></p><p class="c2"><span class="c1">from pizza_sales</span></p><p class="c2"><span class="c1">group by pizza_name</span></p><p class="c2"><span class="c1">ORDER BY Total_Quantity &nbsp;desc;</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 346.00px; height: 201.00px;"><img alt="" src="images/image2.png" style="width: 346.00px; height: 201.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p></body></html>